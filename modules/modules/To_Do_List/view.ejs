<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ToDoList</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.css" />
	<link rel="stylesheet"  href="../modulesCSS/Wetter.css">
	</script>
</head>
<style>
	.section {
    padding: 1rem 1.5rem;
}
	#w{
	
	padding-bottom: 4rem;
}
	.knopf{
		float: left;
		
	}
	
	.loeschen{
		font-size: 50% !important;	
	}
	
	#t{
		opacity: 1;
	}
	.knopf1{
		margin-right: 5%;
		margin-left: 5%;
		width: 90%;
	}
	
	
</style>
<div class="MELLO_ToDoDash">
	<h1>ToDo-List</h1>
    <p>Here you can see your things you have to do !! </p>
<section class="section" id= "w">
        <div class="container">
            <div class="columns">
                <div class="column is-offset-4 is-4" id = "dada">
					
<script>
	
			if(socket !== undefined){
		
				console.log('Connected to socket...');
				
			};
	
		var name="<%=name%>";
	
		socket.emit('todosansage',{
                            name: name
							
                        });
	socket.on('todos', function(data){
				   		
			console.log(data.ToDos);
			console.log(data.ToDos.length);
			
						
			for(var x = data.ToDos.length-1 ; x >= 0; x--){
					var e = document.createElement("div");
					e.setAttribute('class', 'box');
					var adult = document.getElementById("dada");
					adult.appendChild(e);
			
					var article = document.createElement("article");
					article.setAttribute('class', 'media');
					e.appendChild(article);
					
					/*var knopf = document.createElement("div");
					knopf.setAttribute('class', 'knopf');
					article.appendChild(knopf);
				
					var loeschen = document.createElement("input");
					loeschen.setAttribute('class', 'loeschen');
					loeschen.setAttribute('type', 'submit');
					loeschen.setAttribute('value', 'LÃ¶schen');
					knopf.appendChild(loeschen);*/
				
					var knopf1 = document.createElement("div");
					knopf1.setAttribute('class', 'knopf1');
					article.appendChild(knopf1);
				
					var inhalt = document.createElement("p");
					inhalt.setAttribute('class', 'inhalt');
					inhalt.textContent = data.ToDos[x].inhalt;
					knopf1.appendChild(inhalt);
				
					var ww = document.createElement("div");
					ww.setAttribute('class', 'ww');
					article.appendChild(ww);
				
					var checkbox = document.createElement("input");
					checkbox.setAttribute( 'type', 'checkbox');
					checkbox.setAttribute('id', 't');
					ww.appendChild(checkbox);
					let newX = x;
                    let newData = data;
						
					if (data.ToDos[newX].ticked == "checked"){
						//console.log("jaaa");
						checkbox.checked = true;
					
					}else {
						//console.log("nein");
						checkbox.checked = false;
					}
				
				
				
				
				checkbox.addEventListener (
   									'click', function() {
                                        console.log("IGO");
										console.log(newData);
										console.log(newX);
										tick(newData.ToDos[newX].ticked, newData.ToDos[newX].inhalt);  
   														});
   													
													

						
					};
			});
	
	 
	function tick(todo, inhalt){
	
		console.log(todo);
	//console.log(inhalt);
	if (todo ==""|| todo == undefined){
		var ticks = "checked";
	} else {
		var ticks = "";
	};
		console.log("ticks");
		console.log(ticks);
		var id1 = '<%= _user._id %>';
	socket.emit('ticked',{
		id:id1 ,
		ticked: ticks,
		inhalt: inhalt
	});
}
	
	
	</script>
					</div>
                </div>
            </div>
        
    </section>
</div>